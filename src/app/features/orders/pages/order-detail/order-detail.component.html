<div class="order-detail-container" *ngIf="!loading">
  <h2>ðŸ§¾ Order #{{ order?.id }}</h2>

  <p><strong>Phone:</strong> {{ order?.phone }}</p>
  <p><strong>Address:</strong> {{ order?.address }}</p>
  <p><strong>Date:</strong> {{ order?.createdDate }}</p>
  <p><strong>Status:</strong> {{ order?.status }}</p>
  <p><strong>Total Quantity:</strong> {{ order?.quantity }}</p>
  <p><strong>Total Price:</strong> {{ order?.totalPrice | number }}â‚«</p>

  <h3>Items</h3>
  <table *ngIf="order?.orderDetails?.length">
    <thead>
      <tr>
        <th>Book</th>
        <th>Image</th>
        <th>Unit Price</th>
        <th>Quantity</th>
        <th>Total Price</th>
        <th>Created Date</th>
        <th>Updated Date</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of order?.orderDetails">
        <td>{{ item.bookName }}</td>
        <td><img [src]="item.bookImage" alt="{{ item.bookName }}" /></td>
        <td>{{ item.unitPrice | number }}â‚«</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.totalPrice | number }}â‚«</td>
        <td>{{ item.createdDate | date : "dd/MM/yyyy HH:mm" }}</td>
        <td>{{ item.updatedDate | date : "dd/MM/yyyy HH:mm" }}</td>
        <td>
          <select
            [ngModel]="item.status"
            (ngModelChange)="updateStatus(item, $event)"
          >
            <option
              *ngFor="let s of orderStatuses"
              [value]="s.label"
              [disabled]="s.label === 'ORDERED'"
            >
              {{ s.label }}
            </option>
          </select>
        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="!order?.orderDetails?.length">No items in this order.</p>
</div>

<div class="loading-overlay" *ngIf="loading">
  <app-toast-spinner [message]="'Loading'" [visible]="loading"></app-toast-spinner>
</div>
